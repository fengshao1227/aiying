# 钱包功能开发计划

> 生成时间：2025-12-26
> 任务：小程序在线钱包功能开发

---

## 需求概述

- 用户钱包充值（微信支付，1-200元可配置）
- 钱包余额支付订单（支持混合支付）
- 交易记录查询
- 6位数字支付密码
- 后台管理（查看/调整余额、冻结/解冻）
- 审计日志

---

## 数据库设计

### 表结构
1. `user_wallets` - 用户钱包表
2. `wallet_transactions` - 钱包流水表
3. `recharge_orders` - 充值订单表

### SQL文件
位置：`docs/sql/wallet.sql`

---

## API设计

### 用户端 `/v2/wallet`
- GET /info - 获取钱包信息
- POST /password/set - 设置支付密码
- POST /password/verify - 验证支付密码
- POST /recharge - 发起充值
- GET /transactions - 交易记录

### 管理后台 `/v2/admin/wallets`
- GET / - 钱包列表
- GET /{user_id} - 钱包详情
- POST /{user_id}/adjust - 调整余额
- POST /{user_id}/freeze - 冻结
- POST /{user_id}/unfreeze - 解冻
